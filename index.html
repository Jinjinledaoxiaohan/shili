<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        .box {
            width: 1242px;
            overflow: hidden;
            height: 2208px;
        }

        @font-face {
            font-family: 方正黑;
            src: url("font/方正黑.ttf");
        }
        @font-face {
            font-family: PingFang SC Regular;
            src: url("font/PingFang SC Regular.ttf");
        }

        .yh:hover {
            color: #FFFFFF;
        }

        .emoji-box {
            user-select: none;
            overflow-y: auto;
            height: 400px;
        }

    </style>
</head>
<body oncontextmenu=self.event.returnValue=false style="background-color: rgb(218,185,149)">
<button class="save-img" onclick="savaData()"
        style="color: rgb(218,185,149); position: absolute;border: none; padding:5px 5px 5px 5px;font-weight:550;background-color: transparent;border-radius:10px;margin-left:1300px; font-size: 35px;">保存图片
</button>
<div class="box">
    <div style="height: 2208px;width: 1242px;display: flex;position:relative;">

        <div class="abc" contenteditable="true" style="font-weight:;font-family: PingFang SC Regular;position:absolute;display: inline-block;right: 58px; top:396px; color: rgb(141,148,166);font-size: 42px;"></div>

        <img class="image" src="./img/1.jpg" style="position: absolute;height: 2208px;width: 1242px;">

        <div class="cs" style="color: rgb(255,106,173); position: absolute;width: 1242px;text-align: center; top:650px;">
            <div contenteditable class="text8000" style="text-shadow: 0px 1px rgb(0,0,0);font-weight:600;font-family: PingFang SC Regular;display: inline-block; font-size: 84px;">大圣娶亲</div>
        </div>

        <div contenteditable class="text8001" style="text-shadow: 0px 1px rgb(0,0,0);font-weight:400;font-family: PingFang SC Regular;position:absolute;display: inline-block;left: 21px;top:824px;Letter-spacing: 3px;padding-left: 6px; color: rgb(255,255,255);font-size: 45px;">一.二三四五六七八九十十一十二十三十四十五十六十七十八</div>

        <div style="position: absolute;right: 133px; top:1121px;">
            <div contenteditable class="text8002" style="text-shadow: 0px 1px rgb(0,0,0);font-weight:400;font-family: PingFang SC Regular;display: inline-block; color: rgb(255,255,255);font-size: 70px;">陈刀仔</div>
            <div contenteditable style="text-shadow: 0px 1px rgb(0,0,0);font-weight:400;font-family: PingFang SC Regular;display: inline-block; color: rgb(255,255,255);font-size: 70px;">牛p</div>
        </div>

        <div style="position: absolute;right: 133px; top:1258px;">
            <div contenteditable class="text8004 input-content" style="text-shadow: 0px 1px rgb(0,0,0);font-weight:400;font-family: PingFang SC Regular;display: inline-block; color: rgb(255,255,255);font-size: 40px;">上海滩赌圣</div>
        </div>

        <div style="position: absolute;top: 1356px;width: 1242px;height: 1080px;background-color: rgb(249,250,250);">
            <div style="background-image: url('img/2.jpg');width: 1242px;height: 135px;">
                <div contenteditable class="text8005" style="text-shadow: 0px 1px rgb(0,0,0);font-weight:400;font-family: PingFang SC Regular;margin-bottom: 40px; text-align: right; max-width: 600px; float: right;margin-right: 160px;margin-top: 37px; color: rgb(255,255,255);font-size: 41px;">今晚打老虎</div>
            </div>

            <div style="float: right;">

                <div style="background-image: url('img/2.jpg');width: 1242px;height: 135px;">
                    <div contenteditable class="text8006 random-num input-content1" style="text-shadow: 0px 1px rgb(0,0,0);font-weight:400;font-family: PingFang SC Regular;max-width: 800px; float: right; margin-right: 320px;margin-top: 35px; color: rgb(255,255,255);font-size: 41px;">七六五四三二一</div>
                </div>

                <div style="background-image: url('img/2.jpg');width: 1242px;height: 135px;">
                    <div contenteditable class="text8007" style="text-shadow: 0px 1px rgb(0,0,0);font-weight:400;font-family: PingFang SC Regular;max-width: 800px; left: 70px;margin-top: 35px; color: rgb(255,255,255);font-size: 41px;">一二三四五六七</div>
                </div>

            </div>
            <img class="image1" src="img/1.jpg">
            <img src="img/2.jpg" style="margin-top: -3px;">

        </div>

    </div>

    <div style="position: absolute;top: 1356px;">
        <img class="bdb" src="img/2.jpg" style="width: 1242px; height: 880px;">
    </div>

    <div class="wsbl" style="position: absolute;top: 0px;display: none;">
        <img class="image5" src="img/2.jpg" style="height: 2208px;width: 1242px;">
        <div contenteditable="true" class="text80071" style="text-shadow: 0px 1px rgb(0,0,0);font-family: PingFang SC Regular; color: rgb(255,255,255); font-weight: 400;Letter-spacing: 1px; position: absolute;top: 839px;font-size: 50px;max-width: 920px;left: 155px;">一二三四五六七八九十十一十二十三十四十五十六十七十八</div>

        <div contenteditable="true" style="position: absolute;top: 1071px;font-size: 50px;max-width: 900px;left: 155px;font-weight: 400;">
            <div contenteditable="true" style="text-shadow: 0px 1px rgb(0,0,0);font-family: PingFang SC Regular;color: rgb(255,255,255); display: inline-block;margin-right: -14px;">一二三：</div>
            <div contenteditable="true" class="text80072" style="text-shadow: 0px 1px rgb(0,0,0);font-family: PingFang SC Regular;color: rgb(255,255,255); display: inline-block;">三二一</div>
        </div>
        <div contenteditable="true" style="position: absolute;top: 1171px;font-size: 37px;max-width: 900px;left: 155px;font-weight: 400;">
            <div contenteditable="true" style="text-shadow: 0px 1px rgb(0,0,0);font-family: PingFang SC Regular;color: rgb(255,255,255); display: inline-block;margin-right: -14px; ">四五六：</div>
            <div contenteditable="true" class="text80073" style="text-shadow: 0px 1px rgb(0,0,0);font-family: PingFang SC Regular;color: rgb(255,255,255); display: inline-block;">六五四</div>
        </div>
    </div>

</div>

<div style="position: absolute;left: 1150px;top: -100px;width: 1100px;height: 2000px;">

    <label class="show1" style="display: inline-block; position: absolute;right: 700px;top:1500px; font-size: 50px;">
        <span class="show-text1">显示其它</span>
        <input class="show-input1" type="checkbox" style="height: 45px;width: 45px;">
    </label>

    <div style="display: inline-block; position: absolute;right: 50px;top: 300px; font-size: 50px;">背景图片：
        <select style="font-size: 50px; width: 650px;height: 100px;" id="pd" onchange="handleSelectChange()">
            <option value="1">图一</option>
            <option value="2">图二</option>
        </select>
        <button class="btn" style="position: absolute;border: 1px solid black;text-align: center; background-color: rgb(239,239,239); width: 140px; left: 925px;top: -10px; font-size: 45px;">更 换 图 片</button>
    </div>

    <div style="display: inline-block; position: absolute;right: -80px;top: 450px; font-size: 50px;">电影名字：
        <select style="font-size: 50px; width: 380px;height: 100px;" id="pid" onchange="handleSelectChange1()">
            <option value="g">大圣娶亲</option>
            <option value="h">审死官</option>
            <option value="i">大内密探零零发</option>
        </select>

        <select style="font-size: 50px; width: 380px;height: 100px;" id="pdd" onchange="handleSelectChange2()">
            <option value="我这只是喜欢看但我从来不赌">文字一</option>
            <option value="我是内容二">文字二</option>
            <option value="我是内容三">文字三</option>
        </select>
    </div>

    <div style="display: inline-block; position: absolute;right: 700px;top:600px; font-size: 50px;">内容一：
        <input class="text50731" contenteditable
             style="white-space: nowrap;overflow: hidden;display: inline-block;position: absolute;height: 100px;line-height: 100px; font-size: 45px;width: 800px;background-color: #FFFFFF;" value="一二三">

    </div>

    <div style="display: inline-block; position: absolute;right: 700px;top:750px; font-size: 50px;">内容二：
        <input class="text50732" contenteditable
             style="white-space: nowrap;overflow: hidden;display: inline-block;position: absolute;height: 100px;line-height: 100px; font-size: 50px;width: 800px;background-color: #FFFFFF;" value="四五六">
    </div>

    <div style="display: inline-block; position: absolute;right: 700px;top:900px; font-size: 50px;">内容三：
        <input class="text50733" contenteditable
             style="white-space: nowrap;overflow: hidden;display: inline-block;position: absolute;height: 100px;line-height: 100px; font-size: 50px;width: 800px;background-color: #FFFFFF;" value="七八九">
    </div>

    <div style="display: inline-block; position: absolute;right: 700px;top:1050px; font-size: 50px;">内容四：
        <input class="text50734" contenteditable
             style="white-space: nowrap;overflow: hidden;display: inline-block;position: absolute;height: 100px;line-height: 100px; font-size: 50px;width: 800px;background-color: #FFFFFF;" value="一是一">
    </div>

    <div style="display: inline-block; position: absolute;right: 700px;top:1200px; font-size: 50px;">内容五：
        <input class="text50735" contenteditable
             style="white-space: nowrap;overflow: hidden;display: inline-block;position: absolute;height: 100px;line-height: 100px; font-size: 45px;width: 800px;background-color: #FFFFFF;" value="二是二">
    </div>

    <div style="display: inline-block; position: absolute;right: 700px;top:1350px; font-size: 50px;">内容六：
        <input class="text50736" contenteditable
             style="white-space: nowrap;overflow: hidden;display: inline-block;position: absolute;height: 100px;line-height: 100px; font-size: 50px;width: 800px;background-color: #FFFFFF;" value="三十三">
    </div>

    <label class="show" style="display: inline-block; position: absolute;right: 150px;top:1500px; font-size: 50px;">
        <span class="show-text">显示其他文字</span>
        <input class="show-input" type="checkbox" style="height: 45px;width: 45px;">
    </label>

    <div style="display: inline-block; position: absolute;right: 700px;top:1650px; font-size: 50px;">内容七：
        <input class="text50737" contenteditable
             style="display: inline-block;position: absolute;font-size: 50px;width: 800px;background-color: #FFFFFF;height: 100px;line-height: 100px;word-wrap:break-word; " value="四十四">
    </div>

    <div style="display: inline-block; position: absolute;right: 700px;top:1800px; font-size: 50px;">内容八：
        <input class="text50738" contenteditable
             style="white-space: nowrap;overflow: hidden;display: inline-block;position: absolute;height: 100px;line-height: 100px; font-size: 50px;width: 800px;background-color: #FFFFFF;" value="五十五">
    </div>

    <div style="display: inline-block; position: absolute;right: 700px;top:1950px; font-size: 50px;">内容九：
        <input class="text50739" contenteditable
             style="white-space: nowrap;overflow: hidden;display: inline-block;position: absolute;height: 100px;line-height: 100px; font-size: 50px;width: 800px;background-color: #FFFFFF;" value="六十六">
    </div>


</div>

<div style="position: absolute;left:2380px;top:150px;width: 500px;height: 2000px;">

    <div style="position: absolute; top:100px;left: 20px;font-size: 65px;">
       我只是普通文字
    </div>

    <div style="position: absolute; top:290px;left: 20px;font-size: 65px;">
        我只是普通文字
    </div>

    <div style="position: absolute; top:480px;left: 20px;font-size: 65px;">
        我只是普通文字
    </div>

</div>

<div class="function-box" style="position: absolute;left: 2380px; top: 880px;">
    <div class="function-item" style="width: 500px;">
        <p style="font-size: 50px;">点击表情即可在光标处插入表情</p>
        <div class="emoji-box"></div>
    </div>

    <div class="function-item" style="width: 500px;">
        <label style="font-size: 50px;margin-left: 100px;">
            文字 :<input style="font-size: 50px;" type="text" placeholder="点击编辑需要变色文字内容" class="key-words"
                       style="height: 50px;font-size: 50px;">
        </label>
        <label style="font-size: 50px;margin-left: 0px;">
            颜色 :<input style="font-size: 25px;width: 200px;height: 50px;" type="color" class="key-color"
                       value="#5B6B92">
        </label>
        <div>
            <label style="font-size: 50px;margin-left: 0px;">
                有下划线
                <input style="font-size: 50px;height: 50px;width: 50px;" type="radio" name="drone" class="key-checkbox" value="underline">
            </label>
            <label style="font-size: 50px;margin-left: 175px;margin-bottom: 10px;">
                无下划线
                <input style="font-size: 50px;height: 50px;width: 50px;" type="radio" name="drone" class="key-checkbox" value="none" checked>
            </label>
        </div>
        <button style="color: white;margin-bottom:20px;padding:5px 5px 5px 5px;font-weight:550;background-color: #333333;border-radius:10px;margin-left:0px; font-size: 50px;"
                type="button" class="key-button">在光标处插入文字
        </button>
    </div>
</div>

<!-- 引入 html2canvas -->
<script src="html2canvas.js"></script>
<!-- 引入自行封装的截图插件 -->
<script src="screen-shot.js"></script>

<script src="emoji.js"></script>


<script>

    // 获取组件盒子
    let box = document.querySelector('.box')

    // 获取保存按钮
    let saveImg = document.querySelector('.save-img')



    // 点击保存按钮
    saveImg.addEventListener('click', () => {
        saveImgFn('图')
    })

    // 保存图片的方法
    async function saveImgFn(downloadName) {
        // 获取需要转换的dom
        // html2canvas(document.querySelector('.bbx'))
        //     .then(canvas => {
        //         let imgUrl = canvas.toDataURL('image/jpg')
        //         let image = document.createElement('img')
        //         image.src = imgUrl
        //         let a = document.createElement('a')
        //         a.href = imgUrl
        //         a.download = name // 自定义名称
        //         a.click()
        //     })

        // 截图模块
        let canvasBox = document.querySelector('.box')
        // 使用自定义方法进行转换
        await getHtmlImage({canvasBox,downloadName})

    }

</script>

<script>
    let showText = document.querySelector(".show-text")
    let showCheckBox = document.querySelector(".show-input")
    let box3 = document.querySelector(".wsbl")

    showCheckBox.addEventListener('change', (e) => {
        if (e.target.checked) {
            showText.innerText = '显示其他内容'
            box3.style.display = 'block'
        } else {
            showText.innerText = '显示其他内容'
            box3.style.display = 'none'
        }
    })

</script>

<script>
    let kanQuan = document.querySelector(".show-text1")
    let ianBng = document.querySelector(".show-input1")
    let shouSi = document.querySelector(".bdb")

    ianBng.addEventListener('change', (c) => {
        if (c.target.checked) {
            kanQuan.innerText = '收起'
            shouSi.style.display = 'none'
        } else {
            kanQuan.innerText = '显示其它'
            shouSi.style.display = 'block'
        }
    })

</script>

<script>
    function handleSelectChange1() {
        let pid = document.querySelector("#pid");
        let item = pid.options[pid.selectedIndex];
        let box = document.querySelector(".text8000");
        box.innerText = item.innerText
    }
</script>


<script>
    function handleSelectChange2() {
        let pid = document.querySelector("#pdd");
        let item = pid.options[pid.selectedIndex];
        let box = document.querySelector(".text8001");
        box.innerText = item.value
    }
</script>


<script>

    let text5 = document.querySelector(".text50731")
    let text6 = document.querySelector(".text8002")

    formatAddComma(text5, text6)

    // 添加逗号 - 转格式
    function formatAddComma(ele11, ele12) {
        ele11.addEventListener('input', () => {
            const addCommas = (num) => num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,')
            ele12.innerText = addCommas(ele11.value)
        })
    }
</script>


<script>

    let text3 = document.querySelector(".text8003")
    let text4 = document.querySelector(".text50732")

    twoWayBinding(text3, text4)
    twoWayBinding(text4, text3)

    function twoWayBinding(ele1, ele2) {
        ele1.addEventListener('input', () => {
            ele2.innerText = ele1.value
        })
    }
</script>

<script>

    let text7 = document.querySelector(".text8004")
    let text8 = document.querySelector(".text50733")

    text8.addEventListener('input', () => {
        text7.innerText = formatStar(text8.value)
    })

    function formatStar(str) {
        // 位数必须大于 8 位
        if (str.length < 8) {
            return '数字满足8位自动转换'
        }
        // 截取前4位
        let front = str.slice(0, 4)
        // 截取后4位
        let back = str.slice(str.length - 4, str.length)
        // 返回处理后的
        return front + ' *** ' + back
    }

</script>

<script>

    let text11 = document.querySelector(".text8005")
    let text12 = document.querySelector(".text50734")

    twoWayBinding(text11, text12)
    twoWayBinding(text12, text11)

    function twoWayBinding(ele1, ele2) {
        ele1.addEventListener('input', () => {
            ele2.innerText = ele1.value
        })
    }
</script>

<script>

    let text13 = document.querySelector(".text8006")
    let text14 = document.querySelector(".text50735")

    text14.addEventListener('input', () => {
        text13.innerText = formatStar(text14.value)
    })

    function formatStar(str) {
        // 位数必须大于 8 位
        if (str.length < 8) {
            return '数字满足8位自动转换'
        }
        // 截取前4位
        let front = str.slice(0, 4)
        // 截取后4位
        let back = str.slice(str.length - 4, str.length)
        // 返回处理后的
        return front + ' *** ' + back
    }

</script>



<script>

    let text17 = document.querySelector(".text50736")
    let text18 = document.querySelector(".text8007")

    formatAddComma(text17, text18)

    // 添加逗号 - 转格式
    function formatAddComma(ele1, ele2) {
        ele1.addEventListener('input', () => {
            const addCommas = (num) => num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,')
            ele2.innerText = addCommas(ele1.value)
        })
    }
</script>

<script>

    let text19 = document.querySelector(".text80071")
    let text20 = document.querySelector(".text50737")

    twoWayBinding(text19, text20)
    twoWayBinding(text20, text19)

    function twoWayBinding(ele1, ele2) {
        ele1.addEventListener('input', () => {
            ele2.innerText = ele1.value
        })
    }
</script>

<script>

    let text21 = document.querySelector(".text80072")
    let text22 = document.querySelector(".text50738")

    twoWayBinding(text21, text22)
    twoWayBinding(text22, text21)

    function twoWayBinding(ele1, ele2) {
        ele1.addEventListener('input', () => {
            ele2.innerText = ele1.value
        })
    }
</script>

<script>

    let text23 = document.querySelector(".text80073")
    let text24 = document.querySelector(".text50739")

    twoWayBinding(text23, text24)
    twoWayBinding(text24, text23)

    function twoWayBinding(ele1, ele2) {
        ele1.addEventListener('input', () => {
            ele2.innerText = ele1.value
        })
    }
</script>

<script>
    // 需要保存数据的元素
    let text8000 = document.querySelector('.text8000')
    let text8001 = document.querySelector('.text8001')
    let text8002 = document.querySelector('.text8002')
    let text8003 = document.querySelector('.text8003')
    let text8004 = document.querySelector('.text8004')
    let text8005 = document.querySelector('.text8005')
    let text8006 = document.querySelector('.text8006')
    let text8007 = document.querySelector('.text8007')
    let text8008 = document.querySelector('.text8008')
    let text8009 = document.querySelector('.text8009')
    let text80071 = document.querySelector('.text80071')
    let text80072 = document.querySelector('.text80072')
    let text80073 = document.querySelector('.text80073')


    let text50730 = document.querySelector('.text50730')
    let text50731 = document.querySelector('.text50731')
    let text50732 = document.querySelector('.text50732')
    let text50733 = document.querySelector('.text50733')
    let text50734 = document.querySelector('.text50734')
    let text50735 = document.querySelector('.text50735')
    let text50736 = document.querySelector('.text50736')
    let text50737 = document.querySelector('.text50737')
    let text50738 = document.querySelector('.text50738')
    let text50739 = document.querySelector('.text50739')

    getData()

    // 页面初始化获取文字
    function getData() {
        let localText8000 = localStorage.getItem('text8000')
        let localText8001 = localStorage.getItem('text8001')
        let localText8002 = localStorage.getItem('text8002')
        let localText8003 = localStorage.getItem('text8003')
        let localText8004 = localStorage.getItem('text8004')
        let localText8005 = localStorage.getItem('text8005')
        let localText8007 = localStorage.getItem('text8007')
        let localText8006 = localStorage.getItem('text8006')
        let localText8008 = localStorage.getItem('text8008')
        let localText8009 = localStorage.getItem('text8009')
        let localText80071 = localStorage.getItem('text80071')
        let localText80072 = localStorage.getItem('text80072')
        let localText80073 = localStorage.getItem('text80073')

        let localText50730 = localStorage.getItem('text50730')
        let localText50731 = localStorage.getItem('text50731')
        let localText50732 = localStorage.getItem('text50732')
        let localText50733 = localStorage.getItem('text50733')
        let localText50734 = localStorage.getItem('text50734')
        let localText50735 = localStorage.getItem('text50735')
        let localText50736 = localStorage.getItem('text50736')
        let localText50737 = localStorage.getItem('text50737')
        let localText50738 = localStorage.getItem('text50738')
        let localText50739 = localStorage.getItem('text50739')




        if (localText8000) text8000.innerText = localText8000
        if (localText8001) text8001.innerText = localText8001
        if (localText8002) text8002.innerText = localText8002
        if (localText8003) text8003.innerText = localText8003
        if (localText8004) text8004.innerText = localText8004
        if (localText8005) text8005.innerText = localText8005
        if (localText8006) text8006.innerText = localText8006
        if (localText8007) text8007.innerText = localText8007
        if (localText8008) text8008.innerText = localText8008
        if (localText8009) text8009.innerText = localText8009
        if (localText80071) text80071.innerText = localText80071
        if (localText80072) text80072.innerText = localText80072
        if (localText80073) text80073.innerText = localText80073




        if (localText50730) text50730.innerText = localText50730
        if (localText50731) text50731.innerText = localText50731
        if (localText50732) text50732.innerText = localText50732
        if (localText50733) text50733.innerText = localText50733
        if (localText50734) text50734.innerText = localText50734
        if (localText50735) text50735.innerText = localText50735
        if (localText50736) text50736.innerText = localText50736
        if (localText50737) text50737.innerText = localText50737
        if (localText50738) text50738.innerText = localText50738
        if (localText50739) text50739.innerText = localText50739
    }


    // 保存数据的方法
    function savaData() {
        localStorage.setItem('text8000', text8000.innerText)
        localStorage.setItem('text8001', text8001.innerText)
        localStorage.setItem('text8002', text8002.innerText)
        localStorage.setItem('text8003', text8003.innerText)
        localStorage.setItem('text8004', text8004.innerText)
        localStorage.setItem('text8005', text8005.innerText)
        localStorage.setItem('text8006', text8006.innerText)
        localStorage.setItem('text8007', text8007.innerText)
        localStorage.setItem('text8008', text8008.innerText)
        localStorage.setItem('text8009', text8009.innerText)
        localStorage.setItem('text80071', text80071.innerText)
        localStorage.setItem('text80072', text80072.innerText)
        localStorage.setItem('text80073', text80073.innerText)




        localStorage.setItem('text50730', text50730.innerText)
        localStorage.setItem('text50731', text50731.innerText)
        localStorage.setItem('text50732', text50732.innerText)
        localStorage.setItem('text50733', text50733.innerText)
        localStorage.setItem('text50734', text50734.innerText)
        localStorage.setItem('text50735', text50735.innerText)
        localStorage.setItem('text50736', text50736.innerText)
        localStorage.setItem('text50737', text50737.innerText)
        localStorage.setItem('text50738', text50738.innerText)
        localStorage.setItem('text50739', text50739.innerText)
    }

</script>
<script>
    // 获取存放 emoji 的容器
    let emojiBox = document.querySelector('.emoji-box')
    // 循环表情并且渲染到界面上
    emoji.forEach(item => {
        let oImg = document.createElement('img')
        oImg.src = item.src
        oImg.alt = item.alt
        oImg.style.width = "110px"
        oImg.style.height = "110px"
        oImg.style.margin = '5px'
        oImg.style.userSelect = 'none'
        emojiBox.appendChild(oImg)
        // 添加插入表情的点击事件
        oImg.addEventListener('click', function () {
            insertImg(item.src)
        })
    })


    /**
     * 在光标处插入图片
     * @param src 路径
     */
    function insertImg(src) {
        if (window.getSelection) {
            let sel = window.getSelection();
            let range = sel.getRangeAt(0);
            let img = new Image();
            range.deleteContents()
            img.src = src;
            range.insertNode(img);
            range.collapse(false); //对于IE来说，参数不可省略
        }
    }

    // 获取 按钮
    let keyBtn = document.querySelector('.key-button')

    // 点击插入重点文字
    keyBtn.addEventListener('click', () => {
        // 获取 文字
        let keyWords = document.querySelector('.key-words')
        // 获取 颜色
        let keyColor = document.querySelector('.key-color')
        // 获取 下划线
        let keyCheckbox = document.querySelector('.key-checkbox:checked')

        // 插入文字
        insertSpan({
            text: keyWords.value,
            color: keyColor.value,
            underline: keyCheckbox.value
        })
    })

    /**
     * 在光标处插入元素
     * @param text 文字内容
     * @param color 文字颜色
     * @param underline 是否带有下划线
     */
    function insertSpan({text, color, underline}) {
        if (window.getSelection) {
            let sel = window.getSelection();
            let range = sel.getRangeAt(0);
            // 创建元素
            let oSpan = document.createElement('span')
            range.deleteContents()
            oSpan.innerText = text
            oSpan.style.color = color
            oSpan.style.textDecoration = underline
            // 整块选中/删除
            oSpan.setAttribute('contenteditable', false)
            range.insertNode(oSpan);
            range.collapse(false); //对于IE来说，参数不可省略
        }
    }
</script>



</body>
</html>
